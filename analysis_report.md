# RBIF100 Final Project: Bioinformatics Data Analysis & Visualization
### By: Helena Balbat

The apolipoprotein E (APOE) gene is one present in Homo sapiens, which was chosen as the gene of interest for this assignment. The APOE gene is responsible for making apolipoprotein E, a critical protein that transports fats and cholesterol. This protein is the main carrier of cholesterol for neurons in our brains, making the APOE gene an important topic of research. I found that variants of this gene can significantly alter the risk of developing late-onset Alzheimer's disease, which intrigued me to research variants in the Homo sapiens APOE gene at the nucleotide level. According to external research, APOE4 is the biggest genetic risk factor for Alzheimer's disease, possibly affecting amyloid plaque buildup and tau protein pathology, as well as causing inflammation in the brain (PubMed: https://pmc.ncbi.nlm.nih.gov/articles/PMC9644639/). 

Three analyses were performed on the collected dataset. These were (1) the classification of variant types, (2) the assessment of variant density across the APOE gene, and (3) the analysis of nucleotide substitution patterns using transition/transversion ratios. The variant distribution came out uneven meaning ther are functionally important regions, most like regulatory or exon-dense areas. APOE is a somewhat compact gene, so many variants naturally fell into the four bins generated by the code.

NOTE: Transition/transversion analysis was not actively utilized because a large portion of dbSNP entries for APOE have identical reference and alternate alleles in the current reference assembly, making the calculation unreliable. I included the code regardless, but it is apparent that all SNPs are counted as transversions for the APOE gene (even with 300 variants pulled).

Variants are clusted, not evenly spread across the gene. The lowest number of variants across the different bins in Analysis 2A is 36 variants in bp 44909500-44910000, while the highest number of variants in Analysis 2A is 112 variants in bp 44909000-44909500. These numbers are not close together, indicating a large variance. This idea is confirmed in Analysis 2C, where the variance is 923.0 (variants per 500 bp bin ^2). There is substantial variation in how the variants are distributed across genomic bins in the APOE gene. These clusters also indicate that APOE variants are localized, not random. The peak region of variant densities is 44909000-44909500, meaning this region of the APOE gene is most likely important in terms of gene function. The standard deviation of variant density in Analysis 2C is 30.38, meaning that, on average, bin counts differ from the mean by about 30 variants.

Color was used to distinguish variant categories in Figure 1 and Figure 2. One additional figure (Figure 3) was created to further depict variant density analyses.

EXPLAIN WORKFLOW, FINDINGS, AND INTERPRETATIONS

<img src="figure1.png" alt="Figure 1: Variant Type Distribution Across the APOE Gene" width="400">
<img src="figure2.png" alt="Figure 2: Variant Density Across the APOE Gene" width="500">
<img src="figure3.png" alt="Figure 2: Variant Density Per Genomic Bin for the APOE Gene" width="300">

    # ANALYSIS 3: Transition Vs. Translation Ratio
        # Are APOE SNPs primarily transitions (A swaps with G / C swaps with T) or transversions (all other substitutions)?

    # define function tt_ratio and pass it variants
        # calculate the number of transitions and transversions among SNPs in the APOE gene
        # pass the list of dictionaries from step 1
        # return transition and transversion counts

    def tstv_ratio(variants):
        # set initial counts to 0
        transitions = 0
        transversions = 0

        # if the variant is an insertion or deletion (aka not a SNP) skip it
        for v in variants:
            if v["variant_type"] != "SNP":
                continue

            ref = v["reference_allele"].upper()
            alt = v["alternate_allele"].upper()

            # skip non-simple SNPs
            if len(ref) != 1 or len(alt) != 1:
                continue
            
            pair = {ref, alt}

            if pair in [{"A", "G"}, {"C", "T"}]:
                transitions += 1
            else:
                transversions += 1
        
        return transitions, transversions

    # run analysis 3
    ts, tv = tstv_ratio(variant_records)

    # final print statements
    print("\nTransition vs. Transversion Analysis:")
    print(f"Transitions: {ts}")
    print(f"Transversions: {tv}")
    print(f"Transition/Transversion Ratio: {ts / tv if tv > 0 else 'N/A'}")
